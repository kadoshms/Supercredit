/**
* Represents a single purchase module
*/

/**
 * Adds a new Purchase to Parse
 * @param req request from server
 */
var config = require('./config');
var Kaiseki = require('./kaiseki');
//instantiate
var kaiseki = new Kaiseki(config.APP_ID, config.REST_API_KEY);
var className = 'Restrictions';
exports.newRestriction = function(req)
{
	var restriction = [{
			'userId' 			: req.param('userId'),
			'restriction_type' 	: req.param('restriction_type'),
			'restriction_amount': req.param('restriction_amount')
	}]
	kaiseki.createObjects(className, restriction, function(err, res, body, success) {
	            console.log('restriction created = ', body);
	});
};
exports.getRestrictionByUser = function(req){
	var params = {
	  where: { userId: req.param('userId')}
	};
	kaiseki.getObjects(className,  params, function(err, res, body, success) {
	  var i;
	  for(i=0;i<body.length;i++){
	  }
	});
}
/**
 * Get User total restriction by type
 * @param req request from server
 * @param callback function
 */
exports.getUserRestrictionAmountByPurchaseType = function(req,callback){
	var params = {
	  where: { 
		  userId			:	req.param('userId'),
		  restriction_type	:	req.param('purchase_type')
	  }
	};
	kaiseki.getObjects(className,  params, function(err, res, body, success) {
		callback(body[0].restriction_amount)
	});
}